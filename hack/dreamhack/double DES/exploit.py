from pwn import *
from Crypto.Cipher import DES
from tqdm import trange

p = remote("host1.dreamhack.games",20882)

p.recvuntil(b":> ")
hint = bytes.fromhex(p.recvline().decode())

d = {}

for i in trange(2**16):
    key = b'Dream_' + i.to_bytes(2, "big")
    cipher = DES.new(key, DES.MODE_ECB)
    
    r = cipher.encrypt(b'DreamHack_blocks')
    d[r] = key

for i in trange(2**16):
    key = i.to_bytes(2, "big") + b'Hacker'
    cipher = DES.new(key, DES.MODE_ECB)

    r = cipher.decrypt(hint)

    if r in d:
        real_key = d[r] + key

key1 = real_key[:8]
key2 = real_key[8:]

cipher1 = DES.new(key1, DES.MODE_ECB)
cipher2 = DES.new(key2, DES.MODE_ECB)

encrypt = lambda x: cipher2.encrypt(cipher1.encrypt(x))

p.sendline(encrypt(b'give_me_the_flag').hex())
p.interactive()