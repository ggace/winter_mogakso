# FFT
[https://great-bean-71f.notion.site/FFT-23ff71184f4247ebafc516e461892a3c](https://great-bean-71f.notion.site/FFT-23ff71184f4247ebafc516e461892a3c)
이 글은 소프트웨어학과 김민서(github 주인)가 2024 동계모각소 '집가고 싶다' 노션 페이지에 먼저 작성한 글이다.

먼저 fft를 알기 위해서는 ft, 즉 푸리에 변환이 무엇인지부터 알아야 한다. 하지만, 이 페이지에서 푸리에 변환, 이산 푸리에 변환, 고속 푸리에 변환을 모두 살펴보기엔 무리가 있기 때문에 푸리에 변환과 관련된 영상을 보는 것을 추천한다. 

(이 글은 wkipedia의  고속 푸리에 변환 페이지를 읽은 후 작성하는 글이기 때문에 해당 페이지와 유사한 흐름을 가지며, 해당 글을 읽으면서 자신(소프트웨어학과 김민서)의 생각을 추가해 더 쉽게 이해할 수 있도록 쓴 글임을 밝힙니다.)

[https://youtu.be/Mc9PHZ3H36M](https://youtu.be/Mc9PHZ3H36M)

## 이산 푸리에 변환

고속 푸리에 변환을 살펴보기 이전에 이산 푸리에 변환부터 짚고 넘어가자. 이산 푸리에 변환으로 계속 부르기엔 너무 이름이 길기 때문에 dft라 하겠다. 

dft는 아날로그에서의 푸리에변환을 이산 데이터, 즉 디지털 데이터의 주파수를 찾는데 사용하기 위한 방법이다.

푸리에변환과 dft의 식을 살펴보도록 하자.

- 푸리에변환

$$
\hat h(f) = \int^{\infty}_{-\infty} x(x) e^{-2 \pi i f x} dx
$$

- dft

$$
X(k) = \sum^{N-1}_{n=0} x_n e^{\frac{-2\pi k n}{N}}
$$

다음과 같이 적분의 형태를 합의 형태로 바꿔 놓은 것으로 연속되지 않은 데이터를 처리할 수 있다.

이는 각 k에 대해 N번의 연산이 필요하기 때문에 $O(n^2)$의 시간복잡도를 가진다. 

이는 데이터가 늘어날 수록 시간 복잡도가 기하급수적으로 커지기 때문에 이를 개선할 알고리즘이 필요하다.

## 고속 푸리에 변환

고속 푸리에 변환은 dft의 문제점을 해결하기 위해 사용하는 알고리즘으로 결론적으로 말하면, $O(n \log n)$의 시간복잡도를 가진다.  이때, 고속 푸리에 변환은 Fast Fourier Transform, 즉 fft로 부르도록 하겠다.

먼저 dft의 식을 변환하며 fft에 대해 알아보자.

$$
X(k) = \sum^{N-1}_{n=0} x_n e^{\frac{-2\pi k n}{N}} \\

= \sum^{\frac{N-1}{2}}_{n=0} x_{2n} e^{\frac{-2\pi 2nk}{N}} + \sum^{\frac{N-1}{2}}_{n=0} x_{2n+1} e^{\frac{-2\pi (2n+1)k}{N}} \\

= \sum^{\frac{N-1}{2}}_{n=0} x_{2n} e^{\frac{-2\pi nk}{\frac{N}{2}}} + e^{\frac{-2\pi k}{N}}\sum^{\frac{N-1}{2}}_{n=0} x_{2n+1} e^{\frac{-2\pi nk}{\frac{N}{2}}}
$$

이다. 이때, $e^{\frac{-2\pi n}{N}}$는 계속 사용되기 때문에 이를 $W_N$이라 하겠다.

식을 더 변환하기에 앞서 $W_N$의 성질을 먼저 살펴보도록 하자.

$W_N$은 복소평면 상에서 $(1, 0)$에서 시작하여, 단위원 위에서 시계방향으로 $\frac{2\pi}{N} \ (rad)$만큼 움직인 점이며

$W_N^k$는 복소평면 상에서 $(1, 0)$에서 시작하여, 단위원 위에서 시계방향으로 $\frac{2\pi}{N}k \ (rad)$만큼 움직인 점이다.

따라서, 

$W_N^{\frac{N}{2}}$은 $W_N$에서 반바퀴 돈것이기 때문에 $-W_N$,

$W_N^N$은 $W_N$에서 한바퀴 돈것이기 때문에 $W_N$,

$W_{ac}^{bc}$는 $e^{\frac{-2\pi n}{ac}bc} = e^{\frac{-2\pi n}{a}b}$에 따라 $W_a^b$이다.

이제 앞서 변경한 수식을 $W_N$을 사용하여 재구성 해보자.

$$
X_k = \sum^{N-1}_{n=0} x_{n}W_{N}^k \\
= \sum^{\frac{N-1}{2}}_{n=0} x_{2n}W_{N/2}^k + W_N^k\sum^{\frac{N-1}{2}}_{n=0} x_{2n+1}W_{N/2}^k \\
= \sum^{\frac{N-1}{2}}_{n=0} (x_{2n} + x_{2n+1}W_n^k)W_{N/2}^k
$$

로 $x_n$을 두개의 구간으로 나누어 계산할 수 있도록 바뀌었다.

이를 행렬식으로 바꾸면  

$$
F_N = \begin{pmatrix}
X_0 \\
X_1 \\
X_2 \\
... \\
X_{N-1} \\
\end{pmatrix}
 = 
\begin{pmatrix}
W_N^0 & W_N^0 & W_N^0 & ... & W_N^0 \\
W_N^0 & W_N^1 & W_N^2 & ... & W_N^{N-1} \\
W_0 & W_N^2 & W_N^4 & ... & W_N^{2(N-1)} \\
... & ... & ... & & ...\\
W_{0} & W_N^{1(N-1)} & W_N^{2(N-1)} & ... & W_N^{(N-1)(N-1)} \\
\end{pmatrix}
\begin{pmatrix}
x_0 \\
x_1 \\
x_2 \\
... \\
x_{N-1}
\end{pmatrix} \\
 = 
\begin{pmatrix}
W_N^0 & W_N^0 & W_N^0 & ... & W_N^0 \\
W_N^0 & W_N^2 & W_N^4 & ... & W_N^{N-1} \\
W_N^0 & W_N^4 & W_N^8 & ... & W_N^{2(N-1)} \\
... & ... & ... & & ...\\
W_N^{0} & W_N^{2(N-1)} & W_N^{4(N-1)} & ... & W_N^{(N-1)(N-1)} \\
\end{pmatrix}
\begin{pmatrix}
x_0 \\
x_2 \\
x_4 \\
... \\
x_{N-1}
\end{pmatrix}
=
\begin{pmatrix}
W_{N/2}^0 & W_{N/2}^0 & W_{N/2}^0 & ... & W_{N/2}^0 \\
W_N^0 & W_{N/2}^1 & W_{N/2}^2 & ... & W_N^1 W_{N/2}^{(N-2)/2} \\
W_{N/2}^0 & W_{N/2}^2 & W_{N/2}^4 & ... & W_N^2 W_{N/2}^{(N-2)} \\
... & ... & ... & & ...\\
W_{N/2}^{0} & W_{N/2}^{(N-1)} & W_{N/2}^{2(N-1)} & ... & W_N^{N-1}W_{N/2}^{(N-1)(N-2)/2} \\
\end{pmatrix}
\begin{pmatrix}
x_0 \\
x_2 \\
x_4 \\
... \\
x_{N-1}
\end{pmatrix}
$$

이때, $x_{2n+1}$은 앞서 dft의 식을 변환한 듯이, 모두 $W_N^k$가 곱해져있기 때문에 모두 시계방향으로 $\frac{2\pi}{N}k \ (rad)$씩 돌아가있다.

또한, $W_{N/2}^k$에서 $\frac{N}{2} \leq k$일때는 $k \rightarrow k - \frac{N}{2}$, 즉 위의 내용과 $k < \frac{N}{2}$일때의 순서와 같아지게 된다. r그리고 $W_{N/2}^{kn}$에서 $\frac{N}{2} \leq n$일 경우 $n < \frac{N}{2}$일때의 값에서 -부호를 붙인 값에 $W_n^k$를 곱한값이 된다.

$k < \frac{N}{2} \cap n < \frac{N}{2}$인 경우, 이는 $F_{N/2}$와 같아진다.

따라서

$$
T_N = \begin{pmatrix}
W_N^0 & 0 & 0 & ... & 0 \\
0 & W_N^1 & 0 & ... & 0 \\
0 & 0 & W_N^2 & ... & 0 \\
... & ... & ... & & 0 \\
0 & 0 & 0 & ... & W_N^{N-1}
\end{pmatrix}
$$

라고 할 때, 

$$
F_{2N} = \begin{pmatrix}
F_N & T_N F_N \\
F_N & T_{N} W_N^{N/2} F_N
\end{pmatrix}
 = 
\begin{pmatrix}
F_N & T_N F_N \\
F_N & -T_{N} F_N
\end{pmatrix}
 = 
\begin{pmatrix}
I_N & T_N \\
I_N & -T_N
\end{pmatrix}
\begin{pmatrix}
F_N & 0_N \\
0_N & F_N
\end{pmatrix}
$$

임을 확인할 수 있다. 

이때, $x_n$의 값은 역비트순과 같다.

즉, $F_N$을 구하기 위해, $F_{N/2}$를 한번씩만 구하면 되기 때문에 시간복잡도는 각 주파수 k에 대해 $O(\log N)$만큼으로 감소한다.

따라서, $N = 2^t$와 같이 2의 거듭 제곱 꼴의 데이터를 가졌을 때, 분할 정복을 통해 dft를 계산할 수 있고 이를 fft라  부른다.